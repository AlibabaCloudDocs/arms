# 配置数据源

本文介绍了创建自定义监控任务的第1个步骤：配置数据源。在准备好数据源后，需要在ARMS控制台进行简单的配置。

## 背景信息

创建自定义监控时，您有以下三种选择：

-   创建完全自定义的监控：您需要手工完成所有配置工作，包括配置数据源、清洗日志、创建报警等。
-   创建基于标准行业模板的监控：您只需要选择ARMS提供的一种标准行业模板，即可快速创建自定义监控。标准行业模板是指针对某个行业或者某类问题的监控任务解决方案。
-   创建基于自定义模板的监控：您可以将现有的自定义监控导出为模板，并在创建新的自定义监控时导入此模板，以减少手工配置的工作量。

不论选择哪种方式，自定义监控任务的[总体流程](/cn.zh-CN/自定义监控/自定义监控概述.md)都是一致的，区别在于基于模板创建时能利用已有的配置，从而减少手工配置工作量。

## 操作步骤

1.  登录[ARMS控制台](https://arms.console.aliyun.com/#/home)。
2.  在控制台左侧导航栏中选择**自定义监控** \> **监控任务管理**。

3.  在实例列表页面上按需执行以下操作，并在弹出对话框中单击**新建并进行配置**。

    -   如需创建自定义监控任务，在右上角选择**新建监控任务** \> **新建自定义监控**，然后在新建自定义任务对话框中选择**任务区域**，并输入**监控任务名称**。

    -   如需创建基于自定义模板的监控任务，在右上角选择**新建监控任务** \> **导入自定义模板**，然后在新建导入模板任务对话框中选择**任务区域**，输入**监控任务名称**，并在**模板配置**文本框中粘贴准备好的模板文件。

        ![新建导入模版任务对话框](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/152302/156756985043750_zh-CN.png)

        **说明：** 如需将一个现有任务导出为模板，请在监控任务管理页面，单击该任务右侧的**更多** \> **导出模板**，然后在弹出对话框中拷贝任务模板。

4.  在数据源配置页面上的**日志源配置**区域输入日志源类型、日志源路径、编码设置等信息。

    **说明：**

    -   ARMS支持的数据源类型包括云服务器ECS、LogHub、API和MQ。详情参见[数据源概述](/cn.zh-CN/自定义监控/管理数据源/数据源概述.md)。ECS数据源有以下限制：一个文件一次只能被一个任务消费，而且被抓取文件所在目录所含的文件数量不能超过200。
    -   在**日志路径**字段（如有）中，请输入日志的绝对路径，例如/apps/arms.log。如果有多个路径，请以逗号分隔，例如/root/arms01.log,/apps/arms02.log。
    -   编码设置：默认为“自动探测”模式，但建议选择特定编码，因为自动探测可能会导致乱码。
5.  在**日志抓取结果**区域，单击右上角的**日志抓取预览**。

    **说明：** ARMS会从选择的机器日志中抓取部分数据（最多20条）。由于需要建立预抓取的临时通道，一般需要30秒左右。

    日志抓取结果显示在预览窗口中。

    **说明：** 如果预抓取日志不成功，请检查输入的日志源、日志路径和采集目标等信息是否正确。

6.  在数据源配置页面单击**保存**和**下一步**。


## 参考

-   [清洗日志](/cn.zh-CN/自定义监控/创建监控任务/清洗日志.md)
-   [自定义监控概述](/cn.zh-CN/自定义监控/自定义监控概述.md)
-   [数据源概述](/cn.zh-CN/自定义监控/管理数据源/数据源概述.md)

