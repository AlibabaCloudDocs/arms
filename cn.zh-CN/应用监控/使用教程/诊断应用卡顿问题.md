# 诊断应用卡顿问题 {#concept_263798 .concept}

为应用安装 ARMS 探针后，ARMS 将全面监控您的应用。利用 ARMS 应用监控的线程剖析、调用链诊断、接口监控等一系列功能，即可准确定位应用中所有慢调用，帮助您解决应用卡顿问题。

## 问题分析 {#section_b1h_vl5_vfb .section}

网站卡顿、页面加载过慢是互联网应用最常见的问题之一。排查、解决网站卡顿、页面加载过慢等问题通常会花费开发运维人员大量的时间，原因如下：

-   应用链路太长
    -   从前端页面到后台网关，从 Web 应用服务器到后台数据库，任何一个环节出现故障都有可能导致整体卡顿。
    -   采用“微服务”架构的应用，链路更加复杂。而且不同组件可能由不同的团队和人员维护，加剧了问题排查的难度。
-   日志不全或质量欠佳
    -   应用日志是排查线上问题的主要方法，但出现问题的位置往往无法预期，而且“慢”通常是偶发现象，要真正找到“慢”的原因，需要在每个可能出现问题的地方打印日志，记录每一次调用，但是成本太高。
-   监控不足
    -   业务发展过快、应用急速迭代导致业务系统频繁修改接口、增加依赖、代码质量恶化等情况。应用需要一个完善的监控体系来对自动监控应用的每一个接口，自动记录出现问题的调用。

## 解决方案 {#section_yhb_cm5_vfb .section}

为应用安装 ARMS 探针后，即可在不改动应用代码的情况下，利用 ARMS 应用监控的线程剖析、调用链诊断、接口监控等功能，让应用中所有慢调用无处可逃。

## 步骤一：安装 Java 探针 {#section_skw_2m5_vfb .section}

为您的应用安装 ARMS 探针后才能使用 ARMS 应用监控对应用进行全方位监控。

-   为 Java 应用安装探针，请参见[为 Java 应用安装探针](intl.zh-CN/应用监控/开始监控 Java 应用/以普通方式安装探针/为 Java 应用安装探针.md#)。

-   为 PHP 应用安装探针，请参见[为 PHP 应用安装探针](intl.zh-CN/应用监控/开始监控 PHP 应用/为 PHP 应用安装探针.md#)。

-   为 ECS 上的应用安装探针，请参见[为 ECS 中的应用快速安装探针](intl.zh-CN/应用监控/开始监控 Java 应用/以快速方式安装探针/为 ECS 中的应用快速安装探针.md#)。

-   为 EDAS 上的应用安装探针，请参见[为 EDAS 中的应用快速安装探针](intl.zh-CN/应用监控/开始监控 Java 应用/以快速方式安装探针/为 EDAS 中的应用快速安装探针.md#)。

-   为容器服务 Kubernetes 版上的已你用安装探针，请参见[为容器服务 Kubernetes 版应用安装探针](intl.zh-CN/应用监控/开始监控 Java 应用/以普通方式安装探针/为容器服务 Kubernetes 版应用安装探针.md#)。

-   为开源 Kubernetes 中的应用安装探针，请参见[为开源 Kubernetes 环境中的应用安装探针](intl.zh-CN/应用监控/开始监控 Java 应用/以普通方式安装探针/为开源 Kubernetes 环境中的应用安装探针.md#)。


## 步骤二：查看慢 SQL 的统计信息 {#section_zmt_mm5_vfb .section}

为应用安装 ARMS 探针后，ARMS 会收集和展示选定时间内应用的总请求量、平均响应时间、错误数、实时实例数、FullGC 次数、慢 SQL 次数、异常次数和慢调用次数，以及这些指标和上一天的环比、上周的同比升降幅度。请按以下步骤查看慢 SQL 的统计信息。

1.  在 ARMS 控制台左侧导航栏中，单击**应用监控** \> **应用列表**。

2.  在应用列表页面上，单击您的应用名称。

3.  在应用总览页面的概览分析页签顶部，查看慢 SQL 的总数、周同比和日环比数据。

    在本示例中，慢 SQL 次数为 5 次。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/217834/155780390447125_zh-CN.png)


## 步骤三：发现并锁定慢接口 {#section_7lv_gkq_msk .section}

ARMS 在调用链追踪页面展示了被监控的应用提供的所有接口以及这个接口的调用次数和耗时，慢接口会被标注出来，帮助您发现和锁定慢接口。

1.  在 ARMS 控制台左侧导航栏中单击**调用链追踪**。

2.  在调用链追踪的**接口选择**区域选中左侧的调用次数最多的慢接口，在右侧查看慢接口的详细信息。

    本示例中，可以判断慢的问题在数据库的调用上。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/217834/155780390547127_zh-CN.png)


## 步骤四：查看并锁定问题代码 {#section_ww8_dwr_7ht .section}

锁定慢接口后，需要找到问题代码来解决问题。快照是对一次调用的全链路调用的完整记录，包括每一次调用所经过的代码及耗时，可以精准定位慢在哪一行代码上。

1.  在调用链追踪页面单击**调用链追踪**页签。

    在调用链追踪页签内，您可以看到这个接口对应的所有接口的快照。

2.  在调用链追踪页签内单击某一个调用快照的 TraceId，再单击**方法栈**列的放大镜图标，查看问题代码。

    在本示例中，可以看到在耗时为 705 毫秒的调用中，大部分的时间都消耗在了 `SELECT * FROM l_employee` 这次 SQL 调用中，这是一次全表扫描的操作。

    ![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/217834/155780390547129_zh-CN.png)


操作至此，已发现了系统中的一个慢调用的原因，这将有效地帮助您进行下一步的代码优化工作。您还可以返回调用链追踪页面，查看列表中其他慢调用，逐一解决。

## 步骤五：设置报警 {#section_apr_sm5_vfb .section}

除了在出现问题后被动诊断错误原因之外，还可以借助 ARMS 的报警功能占据主动。您可以针对一个接口或全部接口创建报警，在页面接口出现卡顿的第一时间向运维团队发送通知。

创建报警操作步骤请参见[快速创建 ARMS 报警](../../../../intl.zh-CN/快速入门/快速创建 ARMS 报警.md#)。

## 相关文档 {#section_flt_vm5_vfb .section}

-   [创建应用监控任务](../../../../intl.zh-CN/快速入门/创建应用监控任务.md#)
-   [应用接口调用监控](intl.zh-CN/应用监控/控制台功能/应用接口调用监控.md#)
-   [查询调用链](intl.zh-CN/应用监控/控制台功能/查询调用链.md#)
-   [使用线程剖析诊断代码层面的问题](intl.zh-CN/应用监控/使用教程/使用线程剖析诊断代码层面的问题.md#)
-   [快速创建 ARMS 报警](../../../../intl.zh-CN/快速入门/快速创建 ARMS 报警.md#)

