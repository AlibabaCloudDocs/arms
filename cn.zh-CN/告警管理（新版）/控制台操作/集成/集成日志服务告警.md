---
keyword: [告警, 监控, 日志服务]
---

# 集成日志服务告警

本文介绍如何将日志服务产生的告警接入到ARMS告警管理中。

ARMS告警管理功能仅对2021年04月30日0点之后开通ARMS的阿里云账户支持。如果您想体验该功能，请联系ARMS钉钉服务账号`arms160804`开通使用。

ARMS告警管理支持通过WebHook的方式将日志服务产生的告警接入告警管理。告警接入告警管理后可以统一进行处理，解决传统告警配置分散在各个系统中，不同系统提供的告警处理能力各不相同的问题。

日志服务接入ARMS告警管理的方法有以下两种：

-   将日志服务指定Project下的所有告警接入ARMS告警管理，请参见[创建集成并接入日志服务](#section_omn_34m_f05)。
-   将日志服务下的指定告警接入ARMS告警管理，请参见[接入日志服务指定报警规则](#section_whv_3ls_k35)。

## 创建集成并接入日志服务

1.  登录[ARMS控制台](https://arms.console.aliyun.com/#/home)。

2.  在左侧导航栏选择**告警管理** \> **集成**。

3.  在集成页面的支持集成区域单击**日志服务**。

4.  在添加集成配置向导页面，进行以下配置：

    1.  在基本信息向导页输入集成名称和描述，然后单击**下一步**。

    2.  在接入告警事件的Product向导页的全部Product区域，显示了阿里云日志服务的所有Project，选择需要接入告警的Project，单击![right_arrow](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9028155061/p179404.png)图标，然后单击**下一步**。

        **说明：**

        此功能会自动遍历选中的Project中配置的所有告警规则，在这些规则上自动修改告警的请求地址为`https://alerts.aliyuncs.com/api/v1/cm/callback/{{token}}`，其中，`{{token}}`为集成创建时自动生成的密钥。

        ![日志服务集成-步骤2](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7688640261/p270374.png)

    3.  在告警源配置向导页根据需求配置自动恢复告警事件的时间和事件重定义字段，然后单击**保存**。

        ![日志服务集成-步骤3 ](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7688640261/p270377.png)

        **说明：**

        -   事件重定义字段已按照日志服务中的模板变量进行了默认配置，更多字段信息，请参见[模板变量](/cn.zh-CN/告警/告警（旧版）/参考信息/模板变量.md)。
        -   事件重定义字段只能用变量和字符组成的jsonPath格式。
        -   单击向导页底部的**+添加扩展字段**可以自定义新的告警事件字段。
        |参数|说明|
        |--|--|
        |告警源配置|
        |自动恢复告警事件|相同名称和等级的告警，在设置的时间内的多次上报会被合并为一条告警。当一条告警超过设置的时间后不再产生，则该告警状态自动变为已解决。|
        |事件重定义|
        |告警样本值|监控指标的触发值。|
        |告警等级|设置告警等级的映射字段。默认映射如下：        -   critical：P1
        -   error：P2
        -   warning：P3
        -   page：P4 |
        |开始时间|事件开始时间的时间戳。|
        |告警描述|告警事件的详细信息，用于告警通知。最多支持15000字符。|
        |对象类型|告警事件的对象类型，例如：主机。|
        |告警类型|告警事件的来源，集成类型。|
        |告警名称|告警的名称。|
        |事件对象|事件对象的名称，最多支持512个字符。例如：主机test\_10.101.1.1。|
        |事件地址|事件详细信息地址。|
        |结束时间|事件结束时间的时间戳。|

    配置完成后，在集成页面可以查看已创建的日志服务集成。

    ![日志集成密钥 ](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/6325391261/p272438.png)


## 接入日志服务指定报警规则

**说明：** 此操作只支持接入已有的日志服务集成中，创建云监控集成的操作，请参见[创建集成并接入日志服务](#section_omn_34m_f05)。

1.  在集成页面，单击目标日志服务集成的密钥，在集成详情页面复制集成密钥。

2.  登录[日志服务控制台](https://sls.console.aliyun.com)。

3.  单击目标Project。

4.  在左侧导航栏单击**告警**图标。

5.  在左侧告警列表中单击目标告警，在右侧告警概览页面单击右上角的**修改配置**。

6.  在修改告警面板的告警配置导航页中单击**下一步**。

7.  在通知导航页的通知列表中选择WebHook-自定义，然后单击**添加**。

8.  在WebHook-自定义区域设置请求地址为`https://alerts.aliyuncs.com/api/v1/events/{{token}}`，其中，`{{token}}`为集成的密钥。

9.  自定义请求内容后，单击**提交**。


## 添加产品

如果您需要在已有的日志服务集成中添加新的Project的告警，您可以执行以下操作：

1.  在集成页面的目标日志服务集成右侧，选择**更多** \> **选择产品**。

2.  在弹出的对话框，选择需要接入告警的Project，单击![right_arrow](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9028155061/p179404.png)图标，然后单击**保存**。


## 管理集成

对于已经创建的集成，您可以进行以下操作：

-   查看集成：如果您需要查看集成的详细信息，单击目标集成所在行，在集成详情页面查看集成的详细信息。
-   更新密钥：如果您需要修改集成的密钥，在目标集成右侧**操作**列选择**更多** \> **更新密钥**，在弹出的对话框中单击**确认**。

    **说明：** 更新秘钥后，请重新添加日志服务下的Project告警，具体操作，请参见[添加产品](#section_cdg_rkl_5rx)。

-   编辑：如果您需要修改集成信息，在目标集成右侧**操作**列单击**编辑**，在集成详情页面修改集成信息，然后单击**√**图标。
-   启用：如果您需要启用禁用状态的集成，在目标集成右侧**操作**列单击**启用**。
-   禁用：如果您需要禁用启用状态的集成，在目标集成右侧**操作**列单击**禁用**。
-   删除：如果您需要删除集成，在目标集成右侧**操作**列单击**删除**，在弹出的对话框中单击**确认**。

